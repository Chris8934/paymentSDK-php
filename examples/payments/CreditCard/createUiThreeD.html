<!DOCTYPE html><html lang="en"><head><title>examples\payments\CreditCard\createUiThreeD</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="examples\payments\CreditCard\createUiThreeD"><meta name="groc-project-path" content="examples\payments\CreditCard\createUiThreeD.php"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">examples\payments\CreditCard\createUiThreeD.php</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-comment">/**
 * Shop System SDK:
 * - Terms of Use can be found under:
 * https://github.com/wirecard/paymentSDK-php/blob/master/_TERMS_OF_USE
 * - License can be found under:
 * https://github.com/wirecard/paymentSDK-php/blob/master/LICENSE
 */</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h1 id="credit-card-ui-creation">Credit Card UI creation</h1>
<p>Since the credit card data needs to be sent directly to Wirecard, you need to invoke the creation of a special form
for entering the credit card data. This form is created via a javascript. Additional processing also needs
to take place on the client-side, so that the credit card data is not processed and/or stored anywhere else.</p>
<h2 id="required-libraries-and-objects">Required libraries and objects</h2>
<p>To include the necessary files, use the composer for PSR-4 autoloading.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../../../vendor/autoload.php'</span>;
<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../../inc/common.php'</span>;
<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../../inc/config.php'</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Amount</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">TransactionService</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Transaction</span>\<span class="hljs-title">CreditCardTransaction</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="transaction">Transaction</h2>
<h3 id="transaction-service">Transaction Service</h3>
<p>The <em>TransactionService</em> is used to generate the request data needed for the generation of the UI.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$transactionService</span> = <span class="hljs-keyword">new</span> TransactionService(<span class="hljs-variable">$config</span>);

<span class="hljs-variable">$redirectUrl</span> = getUrl(<span class="hljs-string">'return.php?status=success'</span>);
<span class="hljs-variable">$amount</span> = <span class="hljs-keyword">new</span> Amount(<span class="hljs-number">1400</span>, <span class="hljs-string">'EUR'</span>);
<span class="hljs-variable">$orderNumber</span> = <span class="hljs-string">'A2'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="basket-items">Basket items</h3>
<p>A Basket contains one or more items.
For each item you have to set some properties as described here.
Required: name, price, quantity, article number, tax rate.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$item1</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\Item(<span class="hljs-string">'Item 1'</span>, <span class="hljs-keyword">new</span> Amount(<span class="hljs-number">2</span>, <span class="hljs-string">'EUR'</span>), <span class="hljs-number">1</span>);
<span class="hljs-variable">$item1</span>-&gt;setArticleNumber(<span class="hljs-string">'A1'</span>);
<span class="hljs-variable">$item1</span>-&gt;setTaxRate(<span class="hljs-number">400.0</span>);

<span class="hljs-variable">$item2</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\Item(<span class="hljs-string">'Item 2'</span>, <span class="hljs-keyword">new</span> Amount(<span class="hljs-number">6</span>, <span class="hljs-string">'EUR'</span>), <span class="hljs-number">2</span>);
<span class="hljs-variable">$item2</span>-&gt;setArticleNumber(<span class="hljs-string">'B2'</span>);
<span class="hljs-variable">$item2</span>-&gt;setTaxRate(<span class="hljs-number">500.0</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Create a basket to store the items.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$basket</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\Basket();
<span class="hljs-variable">$basket</span>-&gt;add(<span class="hljs-variable">$item1</span>);
<span class="hljs-variable">$basket</span>-&gt;add(<span class="hljs-variable">$item2</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h4 id="account-holder-with-address">Account holder with address</h4></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-variable">$address</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\Address(<span class="hljs-string">'DE'</span>, <span class="hljs-string">'Berlin'</span>, <span class="hljs-string">'Teststrasse'</span>);
<span class="hljs-variable">$address</span>-&gt;setStreet2(<span class="hljs-string">'Test street 2'</span>);
<span class="hljs-variable">$address</span>-&gt;setStreet3(<span class="hljs-string">'Test street 3'</span>);
<span class="hljs-variable">$address</span>-&gt;setPostalCode(<span class="hljs-string">'13353'</span>);
<span class="hljs-variable">$accountHolder</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\AccountHolder();
<span class="hljs-variable">$accountHolder</span>-&gt;setEmail(<span class="hljs-string">'john.doe@test.com'</span>);
<span class="hljs-variable">$accountHolder</span>-&gt;setPhone(<span class="hljs-string">'03018425165'</span>);
<span class="hljs-variable">$accountHolder</span>-&gt;setWorkPhone(<span class="hljs-string">'0765573242'</span>);
<span class="hljs-variable">$accountHolder</span>-&gt;setMobilePhone(<span class="hljs-string">'041232342'</span>);
<span class="hljs-variable">$accountHolder</span>-&gt;setDateOfBirth(<span class="hljs-keyword">new</span> \DateTime(<span class="hljs-string">'1973-12-07'</span>));
<span class="hljs-variable">$accountHolder</span>-&gt;setAddress(<span class="hljs-variable">$address</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="basic-creditcardtransaction">Basic CreditCardTransaction</h3>
<p>Create a CreditCardTransaction with all parameters which should be sent in the initial transaction.
The fields will be mapped for the javascript request.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$transaction</span> = <span class="hljs-keyword">new</span> CreditCardTransaction();
<span class="hljs-variable">$transaction</span>-&gt;setConfig(<span class="hljs-variable">$creditcardConfig</span>);
<span class="hljs-variable">$transaction</span>-&gt;setAmount(<span class="hljs-variable">$amount</span>);
<span class="hljs-variable">$transaction</span>-&gt;setTermUrl(<span class="hljs-variable">$redirectUrl</span>);
<span class="hljs-variable">$transaction</span>-&gt;setNotificationUrl(<span class="hljs-variable">$redirectUrl</span>);
<span class="hljs-variable">$transaction</span>-&gt;setBasket(<span class="hljs-variable">$basket</span>);
<span class="hljs-variable">$transaction</span>-&gt;setOrderNumber(<span class="hljs-variable">$orderNumber</span>);
<span class="hljs-variable">$transaction</span>-&gt;setShipping(<span class="hljs-variable">$accountHolder</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Send custom fields for CreditCard transactions</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$custom_fields</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\CustomFieldCollection();
<span class="hljs-variable">$custom_fields</span>-&gt;add(<span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\CustomField(<span class="hljs-string">'orderId'</span>, <span class="hljs-string">'123'</span>));
<span class="hljs-variable">$transaction</span>-&gt;setCustomFields(<span class="hljs-variable">$custom_fields</span>);
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@since</span> 3.8.0
 * https://doc.wirecard.com/CreditCard.html#CreditCard_3DS2
 * New fields for the CreditCard 3DS 2.X workflow
 * according to EU standards set by EMVCo
 * https://www.emvco.com/document-search/?action=search_documents&amp;publish_date=&amp;emvco_document_version=&amp;emvco_document_book=&amp;px_search=&amp;emvco_document_technology%5B%5D=3-d-secure
 */</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="contains-information-for-the-3ds-requestor">Contains information for the 3DS Requestor</h3>
<p>Information about how the 3DS Requestor authenticated the cardholder before or during the transaction
Possible values 01 guest login, 02 User Account in Shop, 03 federated id, 04 issuer of card credentials, 05 third-party authentication, 06 FIDO authentication</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\AccountInfo();
<span class="hljs-variable">$authenticationInfo</span>-&gt;setAuthMethod(\Wirecard\PaymentSdk\Constant\AuthMethod::GUEST_CHECKOUT);
<span class="hljs-variable">$authenticationInfo</span>-&gt;setAuthTimestamp();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Indicates if a challenge is requested for this transaction, 01 no preference, 02 no challenge, 03 challenge requested 3DS, 04 challenge requested Mandate</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setChallengeInd(\Wirecard\PaymentSdk\Constant\ChallengeInd::NO_PREFERENCE);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="contains-additional-information-about-the-cardholder39s-account-provided-by-the-3ds-requestor">Contains additional information about the Cardholder&#39;s account provided by the 3DS Requestor</h3>
<p>Account creation date</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setCreationDate(<span class="hljs-keyword">new</span> DateTime());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Account update date</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setUpdateDate(<span class="hljs-keyword">new</span> DateTime());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Account password change date</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setPassChangeDate(<span class="hljs-keyword">new</span> DateTime());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Account first usage of the address</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setShippingAddressFirstUse(<span class="hljs-keyword">new</span> DateTime());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Card creation date</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setCardCreationDate(<span class="hljs-keyword">new</span> DateTime());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Number of transactions (successful and abandoned) for this cardholder account across all payment accounts in the previous 24 hours</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setAmountTransactionsLastDay(<span class="hljs-number">2</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Number of transactions (successful and abandoned) for this cardholder account across all payment accounts in the previous year</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setAmountTransactionsLastYear(<span class="hljs-number">500</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Number of card attempts in the previous 24 hours</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setAmountCardTransactionsLastDay(<span class="hljs-number">1</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Number of purchases with this cardholder account during the previous six months</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$authenticationInfo</span>-&gt;setAmountPurchasesLastSixMonths(<span class="hljs-number">30</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Set accountInfo for AccountHolder</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$accountHolder</span>-&gt;setAccountInfo(<span class="hljs-variable">$authenticationInfo</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Additional information about the account provided by the 3DS requestor. Limited to 64 characters</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$accountHolder</span>-&gt;setCrmId(<span class="hljs-string">'12daw2r'</span>);
<span class="hljs-variable">$transaction</span>-&gt;setAccountHolder(<span class="hljs-variable">$accountHolder</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="merchant39s-assessment-of-the-level-of-fraud-risk-for-the-specific-authentication-for-both-the-cardholder-and-the-authentication-being-conducted">Merchant&#39;s assessment of the level of fraud risk for the specific authentication for both the cardholder and the authentication being conducted</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-variable">$merchantRiskIndicator</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\RiskInfo();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Indicates whether cardholder is placing an order for merchandise with a future availability or release date. Merchandise available &#39;01&#39;, Future availability &#39;02&#39;</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$merchantRiskIndicator</span>-&gt;setAvailability(\Wirecard\PaymentSdk\Constant\RiskInfoAvailability::MERCHANDISE_AVAILABLE);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>For electronic delivery, the email address the merchandise was delivered</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$merchantRiskIndicator</span>-&gt;setDeliveryEmailAddress(<span class="hljs-string">'max.muster@mail.com'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Indicates the merchandise delivery timeframe. Electronic Delivery 01, Same day shipping 02, Overnight shipping 03, Two-day or more shipping 04</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$merchantRiskIndicator</span>-&gt;setDeliveryTimeFrame(\Wirecard\PaymentSdk\Constant\RiskInfoDeliveryTimeFrame::ELECTRONIC_DELIVERY);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Expected delivery date for pre-ordered goods</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$merchantRiskIndicator</span>-&gt;setPreOrderDate(<span class="hljs-keyword">new</span> DateTime());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Was the good already bought before. First time ordered 01, Reordered 02</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$merchantRiskIndicator</span>-&gt;setReorderItems(\Wirecard\PaymentSdk\Constant\RiskInfoReorder::FIRST_TIME_ORDERED);
<span class="hljs-variable">$transaction</span>-&gt;setRiskInfo(<span class="hljs-variable">$merchantRiskIndicator</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Transaction type, classification of goods derived from ISO 8583. Goods/Service purchase 01, Check Acceptance 03, Account Funding 10, Quasi-Cash Transaction 11, Prepaid activation and Loan 28</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$transaction</span>-&gt;setIsoTransactionType(\Wirecard\PaymentSdk\Constant\IsoTransactionType::CHECK_ACCEPTANCE);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="contains-browser-information-this-field-is-required-when-devicechannel-is-set-to-02">Contains browser information. This field is required when deviceChannel is set to 02.</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-variable">$browser</span> = <span class="hljs-keyword">new</span> \Wirecard\PaymentSdk\Entity\Browser();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Defines the challenge window size through the given width in px</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$browser</span>-&gt;setChallengeWindowSize(<span class="hljs-number">500</span>);
<span class="hljs-variable">$transaction</span>-&gt;setBrowser(<span class="hljs-variable">$browser</span>);
<span class="hljs-preprocessor">?&gt;</span>

&lt;html&gt;
&lt;head&gt;
    &lt;script src=<span class="hljs-string">"https://code.jquery.com/jquery-3.1.1.min.js"</span> type=<span class="hljs-string">"application/javascript"</span>&gt;&lt;/script&gt;
    &lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"</span>
          integrity=<span class="hljs-string">"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"</span> crossorigin=<span class="hljs-string">"anonymous"</span>&gt;
    <span class="hljs-preprocessor">&lt;?php</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>This library is needed to generate the UI and to get a valid token ID.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-preprocessor">?&gt;</span>
    &lt;script src=<span class="hljs-string">"&lt;?= $baseUrl ?&gt;/engine/hpp/paymentPageLoader.js"</span> type=<span class="hljs-string">"text/javascript"</span>&gt;&lt;/script&gt;
    &lt;style&gt;
        <span class="hljs-comment">#creditcard-form-div {</span>
            height: <span class="hljs-number">300</span>px;
        }
        <span class="hljs-comment">#overrides h1 {</span>
            margin: <span class="hljs-number">0</span>px;
            font-size: <span class="hljs-number">2</span>vw;
        }
        <span class="hljs-comment">#overrides h2 {</span>
            padding-bottom: <span class="hljs-number">10</span>px;
            border-bottom: <span class="hljs-number">1</span>px solid <span class="hljs-comment">#dedede;</span>
        }
        <span class="hljs-comment">#overrides h3 {</span>
            min-height: <span class="hljs-number">52.8</span>px;
        }
        <span class="hljs-comment">#overrides img {</span>
            height: <span class="hljs-number">40</span>px;
            margin: <span class="hljs-number">0</span>px <span class="hljs-number">20</span>px;
        }
        <span class="hljs-comment">#overrides .align-baseline {</span>
            position: relative;
        }
        <span class="hljs-comment">#overrides .bottom-align-text {</span>
            position: absolute;
            bottom: -<span class="hljs-number">0.35</span>vw;
            left: <span class="hljs-number">235</span>px;
        }
        <span class="hljs-comment">#overrides .page-header {</span>
            background-color: <span class="hljs-comment">#002846;</span>
            margin-top: <span class="hljs-number">0</span>px;
            padding: <span class="hljs-number">40</span>px <span class="hljs-number">20</span>px;
            color: white;
        }
        <span class="hljs-comment">#overrides .list-group-item {</span>
            border-radius: <span class="hljs-number">0</span>px;
            text-transform: uppercase;
            font-size: <span class="hljs-number">12</span>px;
        }
        <span class="hljs-comment">#overrides .list-group-item:hover {</span>
            color: <span class="hljs-comment">#ff2014;</span>
            background-color: <span class="hljs-comment">#F7F7F8;</span>
        }
        <span class="hljs-comment">#overrides .btn-primary {</span>
            background-color: <span class="hljs-comment">#002846;</span>
        }
        <span class="hljs-comment">#overrides .btn-primary:hover {</span>
            background-color: <span class="hljs-comment">#414B56;</span>
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body id=<span class="hljs-string">"overrides"</span>&gt;
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">container</span>"&gt;
    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">page</span>-<span class="hljs-title">header</span>"&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">row</span>"&gt;
            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">col</span>-<span class="hljs-title">sm</span>-2"&gt;
                &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>="<span class="hljs-title">https</span>://<span class="hljs-title">raw</span>.<span class="hljs-title">githubusercontent</span>.<span class="hljs-title">com</span>/<span class="hljs-title">wirecard</span>/<span class="hljs-title">paymentSDK</span>-<span class="hljs-title">php</span>/<span class="hljs-title">master</span>/<span class="hljs-title">examples</span>/<span class="hljs-title">src</span>/<span class="hljs-title">img</span>/<span class="hljs-title">wirecard_logo</span>.<span class="hljs-title">png</span>" <span class="hljs-title">alt</span>="<span class="hljs-title">wirecard</span>" /&gt;
            &lt;/<span class="hljs-title">div</span>&gt;
            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">col</span>-<span class="hljs-title">sm</span>-10 <span class="hljs-title">align</span>-<span class="hljs-title">bottom</span>"&gt;
                &lt;<span class="hljs-title">h1</span>&gt;<span class="hljs-title">Payment</span> <span class="hljs-title">SDK</span> <span class="hljs-title">for</span> <span class="hljs-title">PHP</span> <span class="hljs-title">Examples</span>&lt;/<span class="hljs-title">h1</span>&gt;
            &lt;/<span class="hljs-title">div</span>&gt;
        &lt;/<span class="hljs-title">div</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;
    &lt;<span class="hljs-title">form</span> <span class="hljs-title">id</span>="<span class="hljs-title">payment</span>-<span class="hljs-title">form</span>" <span class="hljs-title">method</span>="<span class="hljs-title">post</span>" <span class="hljs-title">action</span>="<span class="hljs-title">reserve</span>.<span class="hljs-title">php</span>"&gt;
        &lt;?<span class="hljs-title">php</span></span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The data, which is returned from the credit card UI, needs to be sent on submitting the form.
In this example this is facilitated via a hidden form field.</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-preprocessor">?&gt;</span>
        <span class="hljs-preprocessor">&lt;?php</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="render-the-form">Render the form</h3>
<p>The javascript library needs a div which it can fill with all credit card related fields.</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-preprocessor">?&gt;</span>
        &lt;div id=<span class="hljs-string">"creditcard-form-div"</span>&gt;&lt;/div&gt;
        &lt;button type=<span class="hljs-string">"submit"</span> <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">btn</span> <span class="hljs-title">btn</span>-<span class="hljs-title">primary</span>"&gt;<span class="hljs-title">Save</span>&lt;/<span class="hljs-title">button</span>&gt;
    &lt;/<span class="hljs-title">form</span>&gt;
&lt;/<span class="hljs-title">div</span>&gt;
&lt;<span class="hljs-title">script</span> <span class="hljs-title">type</span>="<span class="hljs-title">application</span>/<span class="hljs-title">javascript</span>"&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>This function will render the credit card UI in the specified div.</p></div></div><div class="code"><div class="wrapper">    WirecardPaymentPage.seamlessRenderForm({
        <span class="hljs-preprocessor">&lt;?php</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>We can send additional fields if we need to. E.g. shopOrderId</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-variable">$additionalData</span> = [<span class="hljs-string">'shopOrderId'</span> =&gt; <span class="hljs-number">53</span>];
        <span class="hljs-preprocessor">?&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>We fill the <em>requestData</em> with the return value
from the <code>getCreditCardUiWithData</code> method of the <code>transactionService</code> which expects a transaction with all desired parameters.</p></div></div><div class="code"><div class="wrapper">        requestData: <span class="hljs-preprocessor">&lt;?</span>= <span class="hljs-variable">$transactionService</span>-&gt;getCreditCardUiWithData(<span class="hljs-variable">$transaction</span>, <span class="hljs-string">'authorization'</span>, <span class="hljs-string">'en'</span>); <span class="hljs-preprocessor">?&gt;</span>,
        wrappingDivId: <span class="hljs-string">"creditcard-form-div"</span>,
        onSuccess: logCallback,
        onError: logCallback
    });
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logCallback</span><span class="hljs-params">(response)</span> </span>{
        console.log(response);
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="submit-handler-for-the-form">Submit handler for the form</h3>
<p>To prevent the data to be submitted on any other server than the Wirecard server, the credit card UI form
is sent to Wirecard via javascript. You receive a token ID which you need for processing the payment.</p></div></div><div class="code"><div class="wrapper">    $(<span class="hljs-string">'#payment-form'</span>).submit(submit);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submit</span><span class="hljs-params">(event)</span> </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>We check if the response fields are already set.</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-keyword">if</span> ($(<span class="hljs-string">"input#jsresponse"</span>).length ) {
            console.log(<span class="hljs-string">'Sending the following request to your server..'</span>);
            console.log($(event.target).serialize());
        } <span class="hljs-keyword">else</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If not, we will prevent the submission of the form and submit the form of credit card UI instead.</p></div></div><div class="code"><div class="wrapper">            event.preventDefault();
            WirecardPaymentPage.seamlessSubmitForm({
                onSuccess: setParentTransactionId,
                onError: logCallback
            })
        }
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If the submit to Wirecard is successful, <code>seamlessSubmitForm</code> will set the form fields and submit your form to
to your server.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setParentTransactionId</span><span class="hljs-params">(response)</span> </span>{
        <span class="hljs-keyword">var</span> form = $(<span class="hljs-string">'#payment-form'</span>);
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key in response){
            <span class="hljs-keyword">if</span>(response.hasOwnProperty(key)) {
                form.append(<span class="hljs-string">"&lt;input type='hidden' name='"</span> + key + <span class="hljs-string">"' value='"</span> + response[key] + <span class="hljs-string">"'&gt;"</span>);
            }
        }
        form.append(<span class="hljs-string">"&lt;input id='jsresponse' type='hidden' name='jsresponse' value='true'&gt;"</span>);
        form.submit();
    }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</div></div></div></div></body></html>